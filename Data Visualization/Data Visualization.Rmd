---
title: "Introduction to Data Visualization"
subtitle: "Govern for America"  
author: "Jake Rozran"
date: "June 24, 2022"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)

library(tibble)
library(knitr)
library(kableExtra)
library(dplyr)
library(scales)
library(ggplot2)
```

```{r xaringan-themer, include = FALSE, warning = FALSE}
library(xaringanthemer)
style_duo_accent(primary_color = "#1a3f6f", 
                 secondary_color = "#52c0ea",
                 code_font_size = "0.5rem")

# "#f24244"
```

```{r xaringan-logo, echo=FALSE}
library(xaringanExtra)

use_logo(image_url = "data_viz_files/gfa_logo_clear.png",
         exclude_class = "hide_logo",
         link_url = "https://www.govern4america.org/",
         position = css_position(left = "1em", bottom = "-4.5em"))
```

.pull-left[
# Who Am I?

- Please call me Jake (Iâ€™ll accept Jake from State Farm)  

- I am an Adjunct Professor of Data Science and Statistics @ Villanova 
University  

- Data Science Practice Lead at a company called CivicActions  

- Dad; Data Nerd; Philadelphian  

- Please connect with me!  [www.jakelearnsdatascience.com](www.jakelearnsdatascience.com) 
]

.pull-right[
.center[![le](data_viz_files/love run-6.jpg)]
![fam](data_viz_files/family.jpg)
]

---

class: center, middle

# Effective Data Visualization

![data_viz_book](data_viz_files/data_viz_book.jpeg)

---

class: center, middle

# How to Create Effective Charts

![data_viz_process](data_viz_files/process.png)

---

class: left, middle

# 1. Research

This is where you are finding, exploring, and understanding the limitations of 
your data.

```{r iris_explore, echo = FALSE, message = FALSE}
data("iris")

iris <- tibble(iris)
iris %>% 
    head() %>%
    kbl() %>%
    kable_material(c("striped", "hover"))
```

---

class: left, middle

# 2. Edit

This is where you are identifying your key message, choosing the best data to 
convey your message, filtering and simplifying your data, and making numerical 
adjustments.

```{r iris_edit, echo = FALSE, message = FALSE}
sum_iris <- iris %>% 
    group_by(Species) %>% 
    summarise(mean_sepal_length = mean(Sepal.Length),
              mean_sepal_width = mean(Sepal.Width))

iris <- iris %>% 
    left_join(sum_iris, by = "Species") %>% 
    mutate(percent_from_avg_l = (Sepal.Length - mean_sepal_length) / mean_sepal_length,
           percent_from_avg_w = (Sepal.Width - mean_sepal_width) / mean_sepal_width) 

iris <- iris %>% 
    mutate(color = ifelse(percent_from_avg_l == min(iris$percent_from_avg_l), 
                          "black", "red"))

sum_iris %>% 
    rename(`Avg Sepal Length` = mean_sepal_length,
           `Avg Sepal Width` = mean_sepal_width) %>% 
    head() %>%
    kbl() %>%
    kable_material(c("striped", "hover"))
```


---

class: left, middle

# 3. Plot

At this step, you are choosing the proper plot type, ensuring your plot axes are 
correct, title and labels are included, and color and typography are clear.

```{r plot_iris, echo = FALSE}
ggplot(sum_iris, aes(x = reorder(Species, mean_sepal_length), 
                     y = mean_sepal_length)) +
    geom_bar(stat = "identity", fill = "#1a3f6f") + 
    ggtitle("Mean Sepal Length for Iris Data Set", 
            subtitle = "Stock Dataset for Data Science") +
    xlab("Species") +
    ylab("Sepal Length (inches)") +
    coord_flip() + 
    theme(panel.background = element_blank(),
          panel.grid = element_blank(),
          axis.ticks = element_blank())
```

---

class: left, middle

# 4. Review

Often overlooked due to expediency, ensuring the data is accurate will preempt 
questions and enhance trust in the data. 
```{r plot_review, echo = FALSE}
ggplot(iris, aes(x = percent_from_avg_l, 
                 y = percent_from_avg_w, 
                 color = color)) +
    geom_point() + 
    scale_color_manual(values = c("red", "#1a3f6f")) + 
    geom_hline(yintercept = 0) + 
    geom_vline(xintercept = 0) +
    ggtitle("Percent Difference from Averages", 
            subtitle = "Is the Red Point an Outlier or Bad Data?") +
    xlab("Percent Difference from Length") +
    ylab("Percent Difference from Width") +
    scale_x_continuous(labels = percent_format()) +
    scale_y_continuous(labels = percent_format()) +
    theme(panel.background = element_blank(),
          panel.grid = element_blank(),
          axis.ticks = element_blank(),
          legend.position = "none")
```


---

class: center, middle

# Visualization Tips & Tricks


---

class: left, middle

# Plots Speak Louder than Words

.pull-left[
> Company A had revenues of $1MM and Company B had revenues of $750k in FY2021.

]

.pull-right[
```{r plots, echo = FALSE}
plot_dat <- tibble(company = c("A", "B"),
                   revenue = c(1000000, 750000))

ggplot(plot_dat, aes(x = reorder(company, revenue), y = revenue)) +
    geom_bar(stat = "identity", fill = "#1a3f6f") +
    scale_y_continuous(limits = c(0, 1100000)) +
    geom_text(aes(label = dollar(revenue)), hjust = 0, size = 5) + 
    ggtitle("Annual Company Earnings ($)", 
            subtitle = "Visualization Gives a Fuller Understanding of the Data.") +
    xlab("Company") +
    ylab("Revenue ($)") +
    coord_flip() + 
    theme(panel.background = element_blank(),
          panel.grid = element_blank(),
          axis.ticks = element_blank(), 
          axis.text.y = element_text(size = 14),
          axis.text.x = element_blank(),
          axis.title = element_blank(),
          plot.title = element_text(size = 18))
```
]

---

class: left, middle

# Let the Data Speak for Itself

.pull-left[
Do not use any bs to make the graph "pretty." A clean crisp chart allows the 
reader to focus on the data and the message of the story.

This means:

1. No 3D rendering EVER
2. No "pretty" colors (more on this soon)
3. No heavy grid lines
4. NEVER NEVER NEVER a pie chart (though the WSJ doesn't agree with me)
]

.pull-right[
This is bad... e
]

---

# Composing Data Graphics

Anyone can create a data visualization - the hard part is making it tell the 
correct story in the easiest to understand way. 

```{r bad_good, echo = FALSE}
bad_dat <- data.frame(variable = c("a", "b", "c", "d", "e"),
                      value = c(22, 21, 20, 19, 18))

bad_graph <- ggplot(bad_dat, aes(x = "", y = value, fill = variable)) +
    geom_bar(stat = "identity") + 
    coord_polar("y", start = 0) + 
    theme(legend.position = "top",
          legend.title = element_blank(),
          panel.background = element_blank(),
          axis.ticks = element_blank(),
          axis.title = element_blank())

better_graph <- ggplot(bad_dat, aes(x = variable, y = value, fill = variable)) +
    geom_bar(stat = "identity") + 
    geom_text(aes(label = value), color = "black", nudge_y = 1) + 
    theme(legend.position = "top",
          legend.title = element_blank(),
          panel.background = element_blank(),
          axis.ticks = element_blank(),
          axis.title = element_blank(),
          panel.grid.major.y = element_line(color = "light gray"))
```


.pull-left[
```{r bad_graph, echo = FALSE}
bad_graph
```
]

.pull-right[
```{r better_graph, echo = FALSE}
better_graph
```
]